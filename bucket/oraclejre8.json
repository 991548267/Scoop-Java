{
    "description": "Oracle JRE 8",
    "homepage": "https://www.java.com/",
    "version": "8u231",
    "license": "https://www.oracle.com/technetwork/java/javase/terms/license/javase-license.html",
    "architecture": {
        "64bit": {
            "url": "https://javadl.oracle.com/webapps/download/AutoDL?BundleId=240728_5b13a193868b4bf28bcb45c792fce896#/dl.7z",
            "hash": "ba6f45b809c153079983ef92d686057296ce60a5491099e58151f21f8cea5c3d"
        },
        "32bit": {
            "url": "https://javadl.oracle.com/webapps/download/AutoDL?BundleId=240726_5b13a193868b4bf28bcb45c792fce896#/dl.7z",
            "hash": "b0720771276a4c02923c81381dc44cdcea58ed24dbc921c0d1bf90a340b14109"
        }
    },
    "extract_to": "tmp",
    "installer": {
        "script": [
            "Expand-7zipArchive \"$dir\\tmp\\Data1.cab\" \"$dir\\tmp\"",
            "Expand-7zipArchive \"$dir\\tmp\\installerexe\" \"$dir\\tmp\"",
            "Expand-7zipArchive \"$dir\\tmp\\.rsrc\\1033\\RCDATA\\6\"  \"$dir\"",
            "# Convert .pack to .jar, and remove .pack",
            "Push-Location \"$dir\"",
            "Get-ChildItem \"$dir\" -Recurse | Where-Object name -Match '^[^_].*?\\.(?i)pack$' | ForEach-Object {",
            "    $name = $_.fullname -Replace '\\.(?i)pack$', ''",
            "    $pack = \"$name.pack\"",
            "    $jar = \"$name.jar\"",
            "    & \"bin\\unpack200.exe\" \"-r\" \"$pack\" \"$jar\"",
            "}",
            "Remove-Item -Recurse tmp | Out-Null",
            "Pop-Location"
        ]
    },
    "env_add_path": "bin",
    "env_set": {
        "JAVA_HOME": "$dir"
    },
    "checkver": {
        "url": "https://www.java.com/en/download/manual.jsp",
        "regex": "(?smi).*Recommended Version 8 Update (?<update>[\\d]+).*https://javadl.oracle.com/webapps/download/AutoDL\\?BundleId=(?<bundlea>[\\d_a-f]+)\">.*?Windows Offline.*https://javadl.oracle.com/webapps/download/AutoDL\\?BundleId=(?<bundleb>[\\d_a-f]+)\">.*?Windows Offline \\(64-bit\\)",
        "replace": "8u${update}"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://javadl.oracle.com/webapps/download/AutoDL?BundleId=$matchBundleb#/dl.7z"
            },
            "32bit": {
                "url": "https://javadl.oracle.com/webapps/download/AutoDL?BundleId=$matchBundlea#/dl.7z"
            }
        }
    }
}
